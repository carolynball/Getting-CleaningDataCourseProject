options (warn=-1)

library(dplyr)

##Determine current working directory##
getwd()

##change wd if necessary##
setwd("C:/Users/cball/Documents/R/UCI HAR Dataset")

##read labels data into tables##
activity_labels<-read.table("./activity_labels.txt")
features<-read.table("./features.txt")

##read test table data in as objects##
subject_test<-read.table("./test/subject_test.txt")
x_test<-read.table("./test/X_test.txt")
y_test<-read.table("./test/y_test.txt")


##read train table data in as objects##
subject_train<-read.table("./train/subject_train.txt")
x_train<-read.table("./train/X_train.txt")
y_train<-read.table("./train/y_train.txt")


##1. Merges training & test sets to create 1 data set for X, y & subject respectively
##Merge tables into 3 respective entities.  x to x, y to y, and sub to ##
##binding by rows##
xreadings<-rbind(x_test,x_train)
subjectconsol<-rbind(subject_test, subject_train)
yactivity<-rbind(y_test, y_train)

dim(xreadings)
dim(subjectconsol)
dim(yactivity)



##1. Merge consolidated training & test sets x, y and sub into 1 master via column bind##
Mergeddata<-cbind(subjectconsol, yactivity, xreadings)

##Add Column names to the merged and consolidated##
##Assume the first column is the subject, 2nd column "activity" as 6 variables##
##which correspond with 6 values in activity_labels.txt, and features were the##
##x variable train and test data##
colnames(Mergeddata) <- c("subject", "activity","tBodyAcc-mean()-X",
                        "tBodyAcc-mean()-Y",
                        "tBodyAcc-mean()-Z",
                        "tBodyAcc-std()-X",
                        "tBodyAcc-std()-Y",
                        "tBodyAcc-std()-Z",
                        "tBodyAcc-mad()-X",
                        "tBodyAcc-mad()-Y",
                        "tBodyAcc-mad()-Z",
                        "tBodyAcc-max()-X",
                        "tBodyAcc-max()-Y",
                        "tBodyAcc-max()-Z",
                        "tBodyAcc-min()-X",
                        "tBodyAcc-min()-Y",
                        "tBodyAcc-min()-Z",
                        "tBodyAcc-sma()",
                        "tBodyAcc-energy()-X",
                        "tBodyAcc-energy()-Y",
                        "tBodyAcc-energy()-Z",
                        "tBodyAcc-iqr()-X",
                        "tBodyAcc-iqr()-Y",
                        "tBodyAcc-iqr()-Z",
                        "tBodyAcc-entropy()-X",
                        "tBodyAcc-entropy()-Y",
                        "tBodyAcc-entropy()-Z",
                        "tBodyAcc-arCoeff()-X,1",
                        "tBodyAcc-arCoeff()-X,2",
                        "tBodyAcc-arCoeff()-X,3",
                        "tBodyAcc-arCoeff()-X,4",
                        "tBodyAcc-arCoeff()-Y,1",
                        "tBodyAcc-arCoeff()-Y,2",
                        "tBodyAcc-arCoeff()-Y,3",
                        "tBodyAcc-arCoeff()-Y,4",
                        "tBodyAcc-arCoeff()-Z,1",
                        "tBodyAcc-arCoeff()-Z,2",
                        "tBodyAcc-arCoeff()-Z,3",
                        "tBodyAcc-arCoeff()-Z,4",
                        "tBodyAcc-correlation()-X,Y",
                        "tBodyAcc-correlation()-X,Z",
                        "tBodyAcc-correlation()-Y,Z",
                        "tGravityAcc-mean()-X",
                        "tGravityAcc-mean()-Y",
                        "tGravityAcc-mean()-Z",
                        "tGravityAcc-std()-X",
                        "tGravityAcc-std()-Y",
                        "tGravityAcc-std()-Z",
                        "tGravityAcc-mad()-X",
                        "tGravityAcc-mad()-Y",
                        "tGravityAcc-mad()-Z",
                        "tGravityAcc-max()-X",
                        "tGravityAcc-max()-Y",
                        "tGravityAcc-max()-Z",
                        "tGravityAcc-min()-X",
                        "tGravityAcc-min()-Y",
                        "tGravityAcc-min()-Z",
                        "tGravityAcc-sma()",
                        "tGravityAcc-energy()-X",
                        "tGravityAcc-energy()-Y",
                        "tGravityAcc-energy()-Z",
                        "tGravityAcc-iqr()-X",
                        "tGravityAcc-iqr()-Y",
                        "tGravityAcc-iqr()-Z",
                        "tGravityAcc-entropy()-X",
                        "tGravityAcc-entropy()-Y",
                        "tGravityAcc-entropy()-Z",
                        "tGravityAcc-arCoeff()-X,1",
                        "tGravityAcc-arCoeff()-X,2",
                        "tGravityAcc-arCoeff()-X,3",
                        "tGravityAcc-arCoeff()-X,4",
                        "tGravityAcc-arCoeff()-Y,1",
                        "tGravityAcc-arCoeff()-Y,2",
                        "tGravityAcc-arCoeff()-Y,3",
                        "tGravityAcc-arCoeff()-Y,4",
                        "tGravityAcc-arCoeff()-Z,1",
                        "tGravityAcc-arCoeff()-Z,2",
                        "tGravityAcc-arCoeff()-Z,3",
                        "tGravityAcc-arCoeff()-Z,4",
                        "tGravityAcc-correlation()-X,Y",
                        "tGravityAcc-correlation()-X,Z",
                        "tGravityAcc-correlation()-Y,Z",
                        "tBodyAccJerk-mean()-X",
                        "tBodyAccJerk-mean()-Y",
                        "tBodyAccJerk-mean()-Z",
                        "tBodyAccJerk-std()-X",
                        "tBodyAccJerk-std()-Y",
                        "tBodyAccJerk-std()-Z",
                        "tBodyAccJerk-mad()-X",
                        "tBodyAccJerk-mad()-Y",
                        "tBodyAccJerk-mad()-Z",
                        "tBodyAccJerk-max()-X",
                        "tBodyAccJerk-max()-Y",
                        "tBodyAccJerk-max()-Z",
                        "tBodyAccJerk-min()-X",
                        "tBodyAccJerk-min()-Y",
                        "tBodyAccJerk-min()-Z",
                        "tBodyAccJerk-sma()",
                        "tBodyAccJerk-energy()-X",
                        "tBodyAccJerk-energy()-Y",
                        "tBodyAccJerk-energy()-Z",
                        "tBodyAccJerk-iqr()-X",
                        "tBodyAccJerk-iqr()-Y",
                        "tBodyAccJerk-iqr()-Z",
                        "tBodyAccJerk-entropy()-X",
                        "tBodyAccJerk-entropy()-Y",
                        "tBodyAccJerk-entropy()-Z",
                        "tBodyAccJerk-arCoeff()-X,1",
                        "tBodyAccJerk-arCoeff()-X,2",
                        "tBodyAccJerk-arCoeff()-X,3",
                        "tBodyAccJerk-arCoeff()-X,4",
                        "tBodyAccJerk-arCoeff()-Y,1",
                        "tBodyAccJerk-arCoeff()-Y,2",
                        "tBodyAccJerk-arCoeff()-Y,3",
                        "tBodyAccJerk-arCoeff()-Y,4",
                        "tBodyAccJerk-arCoeff()-Z,1",
                        "tBodyAccJerk-arCoeff()-Z,2",
                        "tBodyAccJerk-arCoeff()-Z,3",
                        "tBodyAccJerk-arCoeff()-Z,4",
                        "tBodyAccJerk-correlation()-X,Y",
                        "tBodyAccJerk-correlation()-X,Z",
                        "tBodyAccJerk-correlation()-Y,Z",
                        "tBodyGyro-mean()-X",
                        "tBodyGyro-mean()-Y",
                        "tBodyGyro-mean()-Z",
                        "tBodyGyro-std()-X",
                        "tBodyGyro-std()-Y",
                        "tBodyGyro-std()-Z",
                        "tBodyGyro-mad()-X",
                        "tBodyGyro-mad()-Y",
                        "tBodyGyro-mad()-Z",
                        "tBodyGyro-max()-X",
                        "tBodyGyro-max()-Y",
                        "tBodyGyro-max()-Z",
                        "tBodyGyro-min()-X",
                        "tBodyGyro-min()-Y",
                        "tBodyGyro-min()-Z",
                        "tBodyGyro-sma()",
                        "tBodyGyro-energy()-X",
                        "tBodyGyro-energy()-Y",
                        "tBodyGyro-energy()-Z",
                        "tBodyGyro-iqr()-X",
                        "tBodyGyro-iqr()-Y",
                        "tBodyGyro-iqr()-Z",
                        "tBodyGyro-entropy()-X",
                        "tBodyGyro-entropy()-Y",
                        "tBodyGyro-entropy()-Z",
                        "tBodyGyro-arCoeff()-X,1",
                        "tBodyGyro-arCoeff()-X,2",
                        "tBodyGyro-arCoeff()-X,3",
                        "tBodyGyro-arCoeff()-X,4",
                        "tBodyGyro-arCoeff()-Y,1",
                        "tBodyGyro-arCoeff()-Y,2",
                        "tBodyGyro-arCoeff()-Y,3",
                        "tBodyGyro-arCoeff()-Y,4",
                        "tBodyGyro-arCoeff()-Z,1",
                        "tBodyGyro-arCoeff()-Z,2",
                        "tBodyGyro-arCoeff()-Z,3",
                        "tBodyGyro-arCoeff()-Z,4",
                        "tBodyGyro-correlation()-X,Y",
                        "tBodyGyro-correlation()-X,Z",
                        "tBodyGyro-correlation()-Y,Z",
                        "tBodyGyroJerk-mean()-X",
                        "tBodyGyroJerk-mean()-Y",
                        "tBodyGyroJerk-mean()-Z",
                        "tBodyGyroJerk-std()-X",
                        "tBodyGyroJerk-std()-Y",
                        "tBodyGyroJerk-std()-Z",
                        "tBodyGyroJerk-mad()-X",
                        "tBodyGyroJerk-mad()-Y",
                        "tBodyGyroJerk-mad()-Z",
                        "tBodyGyroJerk-max()-X",
                        "tBodyGyroJerk-max()-Y",
                        "tBodyGyroJerk-max()-Z",
                        "tBodyGyroJerk-min()-X",
                        "tBodyGyroJerk-min()-Y",
                        "tBodyGyroJerk-min()-Z",
                        "tBodyGyroJerk-sma()",
                        "tBodyGyroJerk-energy()-X",
                        "tBodyGyroJerk-energy()-Y",
                        "tBodyGyroJerk-energy()-Z",
                        "tBodyGyroJerk-iqr()-X",
                        "tBodyGyroJerk-iqr()-Y",
                        "tBodyGyroJerk-iqr()-Z",
                        "tBodyGyroJerk-entropy()-X",
                        "tBodyGyroJerk-entropy()-Y",
                        "tBodyGyroJerk-entropy()-Z",
                        "tBodyGyroJerk-arCoeff()-X,1",
                        "tBodyGyroJerk-arCoeff()-X,2",
                        "tBodyGyroJerk-arCoeff()-X,3",
                        "tBodyGyroJerk-arCoeff()-X,4",
                        "tBodyGyroJerk-arCoeff()-Y,1",
                        "tBodyGyroJerk-arCoeff()-Y,2",
                        "tBodyGyroJerk-arCoeff()-Y,3",
                        "tBodyGyroJerk-arCoeff()-Y,4",
                        "tBodyGyroJerk-arCoeff()-Z,1",
                        "tBodyGyroJerk-arCoeff()-Z,2",
                        "tBodyGyroJerk-arCoeff()-Z,3",
                        "tBodyGyroJerk-arCoeff()-Z,4",
                        "tBodyGyroJerk-correlation()-X,Y",
                        "tBodyGyroJerk-correlation()-X,Z",
                        "tBodyGyroJerk-correlation()-Y,Z",
                        "tBodyAccMag-mean()",
                        "tBodyAccMag-std()",
                        "tBodyAccMag-mad()",
                        "tBodyAccMag-max()",
                        "tBodyAccMag-min()",
                        "tBodyAccMag-sma()",
                        "tBodyAccMag-energy()",
                        "tBodyAccMag-iqr()",
                        "tBodyAccMag-entropy()",
                        "tBodyAccMag-arCoeff()1",
                        "tBodyAccMag-arCoeff()2",
                        "tBodyAccMag-arCoeff()3",
                        "tBodyAccMag-arCoeff()4",
                        "tGravityAccMag-mean()",
                        "tGravityAccMag-std()",
                        "tGravityAccMag-mad()",
                        "tGravityAccMag-max()",
                        "tGravityAccMag-min()",
                        "tGravityAccMag-sma()",
                        "tGravityAccMag-energy()",
                        "tGravityAccMag-iqr()",
                        "tGravityAccMag-entropy()",
                        "tGravityAccMag-arCoeff()1",
                        "tGravityAccMag-arCoeff()2",
                        "tGravityAccMag-arCoeff()3",
                        "tGravityAccMag-arCoeff()4",
                        "tBodyAccJerkMag-mean()",
                        "tBodyAccJerkMag-std()",
                        "tBodyAccJerkMag-mad()",
                        "tBodyAccJerkMag-max()",
                        "tBodyAccJerkMag-min()",
                        "tBodyAccJerkMag-sma()",
                        "tBodyAccJerkMag-energy()",
                        "tBodyAccJerkMag-iqr()",
                        "tBodyAccJerkMag-entropy()",
                        "tBodyAccJerkMag-arCoeff()1",
                        "tBodyAccJerkMag-arCoeff()2",
                        "tBodyAccJerkMag-arCoeff()3",
                        "tBodyAccJerkMag-arCoeff()4",
                        "tBodyGyroMag-mean()",
                        "tBodyGyroMag-std()",
                        "tBodyGyroMag-mad()",
                        "tBodyGyroMag-max()",
                        "tBodyGyroMag-min()",
                        "tBodyGyroMag-sma()",
                        "tBodyGyroMag-energy()",
                        "tBodyGyroMag-iqr()",
                        "tBodyGyroMag-entropy()",
                        "tBodyGyroMag-arCoeff()1",
                        "tBodyGyroMag-arCoeff()2",
                        "tBodyGyroMag-arCoeff()3",
                        "tBodyGyroMag-arCoeff()4",
                        "tBodyGyroJerkMag-mean()",
                        "tBodyGyroJerkMag-std()",
                        "tBodyGyroJerkMag-mad()",
                        "tBodyGyroJerkMag-max()",
                        "tBodyGyroJerkMag-min()",
                        "tBodyGyroJerkMag-sma()",
                        "tBodyGyroJerkMag-energy()",
                        "tBodyGyroJerkMag-iqr()",
                        "tBodyGyroJerkMag-entropy()",
                        "tBodyGyroJerkMag-arCoeff()1",
                        "tBodyGyroJerkMag-arCoeff()2",
                        "tBodyGyroJerkMag-arCoeff()3",
                        "tBodyGyroJerkMag-arCoeff()4",
                        "fBodyAcc-mean()-X",
                        "fBodyAcc-mean()-Y",
                        "fBodyAcc-mean()-Z",
                        "fBodyAcc-std()-X",
                        "fBodyAcc-std()-Y",
                        "fBodyAcc-std()-Z",
                        "fBodyAcc-mad()-X",
                        "fBodyAcc-mad()-Y",
                        "fBodyAcc-mad()-Z",
                        "fBodyAcc-max()-X",
                        "fBodyAcc-max()-Y",
                        "fBodyAcc-max()-Z",
                        "fBodyAcc-min()-X",
                        "fBodyAcc-min()-Y",
                        "fBodyAcc-min()-Z",
                        "fBodyAcc-sma()",
                        "fBodyAcc-energy()-X",
                        "fBodyAcc-energy()-Y",
                        "fBodyAcc-energy()-Z",
                        "fBodyAcc-iqr()-X",
                        "fBodyAcc-iqr()-Y",
                        "fBodyAcc-iqr()-Z",
                        "fBodyAcc-entropy()-X",
                        "fBodyAcc-entropy()-Y",
                        "fBodyAcc-entropy()-Z",
                        "fBodyAcc-maxInds-X",
                        "fBodyAcc-maxInds-Y",
                        "fBodyAcc-maxInds-Z",
                        "fBodyAcc-meanFreq()-X",
                        "fBodyAcc-meanFreq()-Y",
                        "fBodyAcc-meanFreq()-Z",
                        "fBodyAcc-skewness()-X",
                        "fBodyAcc-kurtosis()-X",
                        "fBodyAcc-skewness()-Y",
                        "fBodyAcc-kurtosis()-Y",
                        "fBodyAcc-skewness()-Z",
                        "fBodyAcc-kurtosis()-Z",
                        "fBodyAcc-bandsEnergy()-1,8",
                        "fBodyAcc-bandsEnergy()-9,16",
                        "fBodyAcc-bandsEnergy()-17,24",
                        "fBodyAcc-bandsEnergy()-25,32",
                        "fBodyAcc-bandsEnergy()-33,40",
                        "fBodyAcc-bandsEnergy()-41,48",
                        "fBodyAcc-bandsEnergy()-49,56",
                        "fBodyAcc-bandsEnergy()-57,64",
                        "fBodyAcc-bandsEnergy()-1,16",
                        "fBodyAcc-bandsEnergy()-17,32",
                        "fBodyAcc-bandsEnergy()-33,48",
                        "fBodyAcc-bandsEnergy()-49,64",
                        "fBodyAcc-bandsEnergy()-1,24",
                        "fBodyAcc-bandsEnergy()-25,48",
                        "fBodyAcc-bandsEnergy()-1,8",
                        "fBodyAcc-bandsEnergy()-9,16",
                        "fBodyAcc-bandsEnergy()-17,24",
                        "fBodyAcc-bandsEnergy()-25,32",
                        "fBodyAcc-bandsEnergy()-33,40",
                        "fBodyAcc-bandsEnergy()-41,48",
                        "fBodyAcc-bandsEnergy()-49,56",
                        "fBodyAcc-bandsEnergy()-57,64",
                        "fBodyAcc-bandsEnergy()-1,16",
                        "fBodyAcc-bandsEnergy()-17,32",
                        "fBodyAcc-bandsEnergy()-33,48",
                        "fBodyAcc-bandsEnergy()-49,64",
                        "fBodyAcc-bandsEnergy()-1,24",
                        "fBodyAcc-bandsEnergy()-25,48",
                        "fBodyAcc-bandsEnergy()-1,8",
                        "fBodyAcc-bandsEnergy()-9,16",
                        "fBodyAcc-bandsEnergy()-17,24",
                        "fBodyAcc-bandsEnergy()-25,32",
                        "fBodyAcc-bandsEnergy()-33,40",
                        "fBodyAcc-bandsEnergy()-41,48",
                        "fBodyAcc-bandsEnergy()-49,56",
                        "fBodyAcc-bandsEnergy()-57,64",
                        "fBodyAcc-bandsEnergy()-1,16",
                        "fBodyAcc-bandsEnergy()-17,32",
                        "fBodyAcc-bandsEnergy()-33,48",
                        "fBodyAcc-bandsEnergy()-49,64",
                        "fBodyAcc-bandsEnergy()-1,24",
                        "fBodyAcc-bandsEnergy()-25,48",
                        "fBodyAccJerk-mean()-X",
                        "fBodyAccJerk-mean()-Y",
                        "fBodyAccJerk-mean()-Z",
                        "fBodyAccJerk-std()-X",
                        "fBodyAccJerk-std()-Y",
                        "fBodyAccJerk-std()-Z",
                        "fBodyAccJerk-mad()-X",
                        "fBodyAccJerk-mad()-Y",
                        "fBodyAccJerk-mad()-Z",
                        "fBodyAccJerk-max()-X",
                        "fBodyAccJerk-max()-Y",
                        "fBodyAccJerk-max()-Z",
                        "fBodyAccJerk-min()-X",
                        "fBodyAccJerk-min()-Y",
                        "fBodyAccJerk-min()-Z",
                        "fBodyAccJerk-sma()",
                        "fBodyAccJerk-energy()-X",
                        "fBodyAccJerk-energy()-Y",
                        "fBodyAccJerk-energy()-Z",
                        "fBodyAccJerk-iqr()-X",
                        "fBodyAccJerk-iqr()-Y",
                        "fBodyAccJerk-iqr()-Z",
                        "fBodyAccJerk-entropy()-X",
                        "fBodyAccJerk-entropy()-Y",
                        "fBodyAccJerk-entropy()-Z",
                        "fBodyAccJerk-maxInds-X",
                        "fBodyAccJerk-maxInds-Y",
                        "fBodyAccJerk-maxInds-Z",
                        "fBodyAccJerk-meanFreq()-X",
                        "fBodyAccJerk-meanFreq()-Y",
                        "fBodyAccJerk-meanFreq()-Z",
                        "fBodyAccJerk-skewness()-X",
                        "fBodyAccJerk-kurtosis()-X",
                        "fBodyAccJerk-skewness()-Y",
                        "fBodyAccJerk-kurtosis()-Y",
                        "fBodyAccJerk-skewness()-Z",
                        "fBodyAccJerk-kurtosis()-Z",
                        "fBodyAccJerk-bandsEnergy()-1,8",
                        "fBodyAccJerk-bandsEnergy()-9,16",
                        "fBodyAccJerk-bandsEnergy()-17,24",
                        "fBodyAccJerk-bandsEnergy()-25,32",
                        "fBodyAccJerk-bandsEnergy()-33,40",
                        "fBodyAccJerk-bandsEnergy()-41,48",
                        "fBodyAccJerk-bandsEnergy()-49,56",
                        "fBodyAccJerk-bandsEnergy()-57,64",
                        "fBodyAccJerk-bandsEnergy()-1,16",
                        "fBodyAccJerk-bandsEnergy()-17,32",
                        "fBodyAccJerk-bandsEnergy()-33,48",
                        "fBodyAccJerk-bandsEnergy()-49,64",
                        "fBodyAccJerk-bandsEnergy()-1,24",
                        "fBodyAccJerk-bandsEnergy()-25,48",
                        "fBodyAccJerk-bandsEnergy()-1,8",
                        "fBodyAccJerk-bandsEnergy()-9,16",
                        "fBodyAccJerk-bandsEnergy()-17,24",
                        "fBodyAccJerk-bandsEnergy()-25,32",
                        "fBodyAccJerk-bandsEnergy()-33,40",
                        "fBodyAccJerk-bandsEnergy()-41,48",
                        "fBodyAccJerk-bandsEnergy()-49,56",
                        "fBodyAccJerk-bandsEnergy()-57,64",
                        "fBodyAccJerk-bandsEnergy()-1,16",
                        "fBodyAccJerk-bandsEnergy()-17,32",
                        "fBodyAccJerk-bandsEnergy()-33,48",
                        "fBodyAccJerk-bandsEnergy()-49,64",
                        "fBodyAccJerk-bandsEnergy()-1,24",
                        "fBodyAccJerk-bandsEnergy()-25,48",
                        "fBodyAccJerk-bandsEnergy()-1,8",
                        "fBodyAccJerk-bandsEnergy()-9,16",
                        "fBodyAccJerk-bandsEnergy()-17,24",
                        "fBodyAccJerk-bandsEnergy()-25,32",
                        "fBodyAccJerk-bandsEnergy()-33,40",
                        "fBodyAccJerk-bandsEnergy()-41,48",
                        "fBodyAccJerk-bandsEnergy()-49,56",
                        "fBodyAccJerk-bandsEnergy()-57,64",
                        "fBodyAccJerk-bandsEnergy()-1,16",
                        "fBodyAccJerk-bandsEnergy()-17,32",
                        "fBodyAccJerk-bandsEnergy()-33,48",
                        "fBodyAccJerk-bandsEnergy()-49,64",
                        "fBodyAccJerk-bandsEnergy()-1,24",
                        "fBodyAccJerk-bandsEnergy()-25,48",
                        "fBodyGyro-mean()-X",
                        "fBodyGyro-mean()-Y",
                        "fBodyGyro-mean()-Z",
                        "fBodyGyro-std()-X",
                        "fBodyGyro-std()-Y",
                        "fBodyGyro-std()-Z",
                        "fBodyGyro-mad()-X",
                        "fBodyGyro-mad()-Y",
                        "fBodyGyro-mad()-Z",
                        "fBodyGyro-max()-X",
                        "fBodyGyro-max()-Y",
                        "fBodyGyro-max()-Z",
                        "fBodyGyro-min()-X",
                        "fBodyGyro-min()-Y",
                        "fBodyGyro-min()-Z",
                        "fBodyGyro-sma()",
                        "fBodyGyro-energy()-X",
                        "fBodyGyro-energy()-Y",
                        "fBodyGyro-energy()-Z",
                        "fBodyGyro-iqr()-X",
                        "fBodyGyro-iqr()-Y",
                        "fBodyGyro-iqr()-Z",
                        "fBodyGyro-entropy()-X",
                        "fBodyGyro-entropy()-Y",
                        "fBodyGyro-entropy()-Z",
                        "fBodyGyro-maxInds-X",
                        "fBodyGyro-maxInds-Y",
                        "fBodyGyro-maxInds-Z",
                        "fBodyGyro-meanFreq()-X",
                        "fBodyGyro-meanFreq()-Y",
                        "fBodyGyro-meanFreq()-Z",
                        "fBodyGyro-skewness()-X",
                        "fBodyGyro-kurtosis()-X",
                        "fBodyGyro-skewness()-Y",
                        "fBodyGyro-kurtosis()-Y",
                        "fBodyGyro-skewness()-Z",
                        "fBodyGyro-kurtosis()-Z",
                        "fBodyGyro-bandsEnergy()-1,8",
                        "fBodyGyro-bandsEnergy()-9,16",
                        "fBodyGyro-bandsEnergy()-17,24",
                        "fBodyGyro-bandsEnergy()-25,32",
                        "fBodyGyro-bandsEnergy()-33,40",
                        "fBodyGyro-bandsEnergy()-41,48",
                        "fBodyGyro-bandsEnergy()-49,56",
                        "fBodyGyro-bandsEnergy()-57,64",
                        "fBodyGyro-bandsEnergy()-1,16",
                        "fBodyGyro-bandsEnergy()-17,32",
                        "fBodyGyro-bandsEnergy()-33,48",
                        "fBodyGyro-bandsEnergy()-49,64",
                        "fBodyGyro-bandsEnergy()-1,24",
                        "fBodyGyro-bandsEnergy()-25,48",
                        "fBodyGyro-bandsEnergy()-1,8",
                        "fBodyGyro-bandsEnergy()-9,16",
                        "fBodyGyro-bandsEnergy()-17,24",
                        "fBodyGyro-bandsEnergy()-25,32",
                        "fBodyGyro-bandsEnergy()-33,40",
                        "fBodyGyro-bandsEnergy()-41,48",
                        "fBodyGyro-bandsEnergy()-49,56",
                        "fBodyGyro-bandsEnergy()-57,64",
                        "fBodyGyro-bandsEnergy()-1,16",
                        "fBodyGyro-bandsEnergy()-17,32",
                        "fBodyGyro-bandsEnergy()-33,48",
                        "fBodyGyro-bandsEnergy()-49,64",
                        "fBodyGyro-bandsEnergy()-1,24",
                        "fBodyGyro-bandsEnergy()-25,48",
                        "fBodyGyro-bandsEnergy()-1,8",
                        "fBodyGyro-bandsEnergy()-9,16",
                        "fBodyGyro-bandsEnergy()-17,24",
                        "fBodyGyro-bandsEnergy()-25,32",
                        "fBodyGyro-bandsEnergy()-33,40",
                        "fBodyGyro-bandsEnergy()-41,48",
                        "fBodyGyro-bandsEnergy()-49,56",
                        "fBodyGyro-bandsEnergy()-57,64",
                        "fBodyGyro-bandsEnergy()-1,16",
                        "fBodyGyro-bandsEnergy()-17,32",
                        "fBodyGyro-bandsEnergy()-33,48",
                        "fBodyGyro-bandsEnergy()-49,64",
                        "fBodyGyro-bandsEnergy()-1,24",
                        "fBodyGyro-bandsEnergy()-25,48",
                        "fBodyAccMag-mean()",
                        "fBodyAccMag-std()",
                        "fBodyAccMag-mad()",
                        "fBodyAccMag-max()",
                        "fBodyAccMag-min()",
                        "fBodyAccMag-sma()",
                        "fBodyAccMag-energy()",
                        "fBodyAccMag-iqr()",
                        "fBodyAccMag-entropy()",
                        "fBodyAccMag-maxInds",
                        "fBodyAccMag-meanFreq()",
                        "fBodyAccMag-skewness()",
                        "fBodyAccMag-kurtosis()",
                        "fBodyBodyAccJerkMag-mean()",
                        "fBodyBodyAccJerkMag-std()",
                        "fBodyBodyAccJerkMag-mad()",
                        "fBodyBodyAccJerkMag-max()",
                        "fBodyBodyAccJerkMag-min()",
                        "fBodyBodyAccJerkMag-sma()",
                        "fBodyBodyAccJerkMag-energy()",
                        "fBodyBodyAccJerkMag-iqr()",
                        "fBodyBodyAccJerkMag-entropy()",
                        "fBodyBodyAccJerkMag-maxInds",
                        "fBodyBodyAccJerkMag-meanFreq()",
                        "fBodyBodyAccJerkMag-skewness()",
                        "fBodyBodyAccJerkMag-kurtosis()",
                        "fBodyBodyGyroMag-mean()",
                        "fBodyBodyGyroMag-std()",
                        "fBodyBodyGyroMag-mad()",
                        "fBodyBodyGyroMag-max()",
                        "fBodyBodyGyroMag-min()",
                        "fBodyBodyGyroMag-sma()",
                        "fBodyBodyGyroMag-energy()",
                        "fBodyBodyGyroMag-iqr()",
                        "fBodyBodyGyroMag-entropy()",
                        "fBodyBodyGyroMag-maxInds",
                        "fBodyBodyGyroMag-meanFreq()",
                        "fBodyBodyGyroMag-skewness()",
                        "fBodyBodyGyroMag-kurtosis()",
                        "fBodyBodyGyroJerkMag-mean()",
                        "fBodyBodyGyroJerkMag-std()",
                        "fBodyBodyGyroJerkMag-mad()",
                        "fBodyBodyGyroJerkMag-max()",
                        "fBodyBodyGyroJerkMag-min()",
                        "fBodyBodyGyroJerkMag-sma()",
                        "fBodyBodyGyroJerkMag-energy()",
                        "fBodyBodyGyroJerkMag-iqr()",
                        "fBodyBodyGyroJerkMag-entropy()",
                        "fBodyBodyGyroJerkMag-maxInds",
                        "fBodyBodyGyroJerkMag-meanFreq()",
                        "fBodyBodyGyroJerkMag-skewness()",
                        "fBodyBodyGyroJerkMag-kurtosis()",
                        "angle(tBodyAccMean,gravity)",
                        "angle(tBodyAccJerkMean),gravityMean)",
                        "angle(tBodyGyroMean,gravityMean)",
                        "angle(tBodyGyroJerkMean,gravityMean)",
                        "angle(X,gravityMean)",
                        "angle(Y,gravityMean)",
                        "angle(Z,gravityMean)")


##Per course instructions #2, extracts only the measurements that include##
##the mean and standard deviation for each measurement into new table Mergeddata2##


Mergeddata2<-Mergeddata[,c("subject", "activity","tBodyAcc-mean()-X",
             "tBodyAcc-mean()-Y",
             "tBodyAcc-mean()-Z",
             "tBodyAcc-std()-X",
             "tBodyAcc-std()-Y",
             "tBodyAcc-std()-Z",
             "tGravityAcc-mean()-X",
             "tGravityAcc-mean()-Y",
             "tGravityAcc-mean()-Z",
             "tGravityAcc-std()-X",
             "tGravityAcc-std()-Y",
             "tGravityAcc-std()-Z",
             "tBodyAccJerk-mean()-X",
             "tBodyAccJerk-mean()-Y",
             "tBodyAccJerk-mean()-Z",
             "tBodyAccJerk-std()-X",
             "tBodyAccJerk-std()-Y",
             "tBodyAccJerk-std()-Z",
             "tBodyGyro-mean()-X",
             "tBodyGyro-mean()-Y",
             "tBodyGyro-mean()-Z",
             "tBodyGyro-std()-X",
             "tBodyGyro-std()-Y",
             "tBodyGyro-std()-Z",
             "tBodyGyroJerk-mean()-X",
             "tBodyGyroJerk-mean()-Y",
             "tBodyGyroJerk-mean()-Z",
             "tBodyGyroJerk-std()-X",
             "tBodyGyroJerk-std()-Y",
             "tBodyGyroJerk-std()-Z",
           "tBodyAccMag-mean()",
             "tBodyAccMag-std()",
             "tGravityAccMag-mean()",
             "tGravityAccMag-std()",
               "tBodyAccJerkMag-mean()",
             "tBodyAccJerkMag-std()",
             "tBodyGyroMag-mean()",
             "tBodyGyroMag-std()",
             "tBodyGyroJerkMag-mean()",
             "tBodyGyroJerkMag-std()",
             "fBodyAcc-mean()-X",
             "fBodyAcc-mean()-Y",
             "fBodyAcc-mean()-Z",
             "fBodyAcc-std()-X",
             "fBodyAcc-std()-Y",
             "fBodyAcc-std()-Z",
             "fBodyAccJerk-mean()-X",
             "fBodyAccJerk-mean()-Y",
             "fBodyAccJerk-mean()-Z",
             "fBodyAccJerk-std()-X",
             "fBodyAccJerk-std()-Y",
             "fBodyAccJerk-std()-Z",
             "fBodyGyro-mean()-X",
             "fBodyGyro-mean()-Y",
             "fBodyGyro-mean()-Z",
             "fBodyGyro-std()-X",
             "fBodyGyro-std()-Y",
             "fBodyGyro-std()-Z",
             "fBodyAccMag-mean()",
             "fBodyAccMag-std()",
             "fBodyBodyAccJerkMag-mean()",
             "fBodyBodyAccJerkMag-std()",
             "fBodyBodyGyroMag-mean()",
            "fBodyBodyGyroMag-std()",
             "fBodyBodyGyroJerkMag-mean()",
             "fBodyBodyGyroJerkMag-std()",
             "angle(tBodyAccMean,gravity)",
             "angle(tBodyAccJerkMean),gravityMean)",
             "angle(tBodyGyroMean,gravityMean)",
             "angle(tBodyGyroJerkMean,gravityMean)",
             "angle(X,gravityMean)",
             "angle(Y,gravityMean)",
             "angle(Z,gravityMean)")]


## add correct activity labels to the consolidated table.##
##Merge activity labels by linking activity (numeric value) and activity label.##
Mergeddata3<-merge(Mergeddata2, activity_labels, by.x="activity", by.y = "V1")


## Add the column name for activity labels##
colnames(Mergeddata3)[colnames(Mergeddata3)=="V2"]<-"activitylabel"

##Check for NA values##
any(is.na(Mergeddata3))


##Creates an independent tidy data set w/the average of each variable for each activity & each subject
AveVariablebySubjectActivity<-Mergeddata3%.%
      group_by(subject,activitylabel)%.%
      summarise("avg-tBodyAcc-mean-X"=mean(Mergeddata3$"tBodyAcc-mean()-X"),
                "avg-tBodyAcc-mean-Y"=mean(Mergeddata3$"tBodyAcc-mean()-Y"),
                "avg-tBodyAcc-mean-Z"=mean(Mergeddata3$"tBodyAcc-mean()-Z"),
                "avg-tBodyAcc-std-X"=mean(Mergeddata3$"tBodyAcc-std()-X"),
                "avg-tBodyAcc-std-Y"=mean(Mergeddata3$"tBodyAcc-std()-Y"),
                "avg-tBodyAcc-std-Z"=mean(Mergeddata3$"tBodyAcc-std()-Z"),
                "avg-tGravityAcc-mean-X"=mean(Mergeddata3$"tGravityAcc-mean()-X"),
                "avg-tGravityAcc-mean-Y"=mean(Mergeddata3$"tGravityAcc-mean()-Y"),
                "avg-tGravityAcc-mean-Z"=mean(Mergeddata3$"tGravityAcc-mean()-Z"),
                "avg-tGravityAcc-std-X"=mean(Mergeddata3$"tGravityAcc-std()-X"),
                "avg-tGravityAcc-std-Y"=mean(Mergeddata3$"tGravityAcc-std()-Y"),
                "avg-tGravityAcc-std-Z"=mean(Mergeddata3$"tGravityAcc-std()-Z"),
                "avg-tBodyAccJerk-mean-X"=mean(Mergeddata3$"tBodyAccJerk-mean()-X"),
                "avg-tBodyAccJerk-mean-Y"=mean(Mergeddata3$"tBodyAccJerk-mean()-Y"),
                "avg-tBodyAccJerk-mean-Z"=mean(Mergeddata3$"tBodyAccJerk-mean()-Z"),
                "avg-tBodyAccJerk-std-X"=mean(Mergeddata3$"tBodyAccJerk-std()-X"),
                "avg-tBodyAccJerk-std-Y"=mean(Mergeddata3$"tBodyAccJerk-std()-Y"),
                "avg-tBodyAccJerk-std-Z"=mean(Mergeddata3$"tBodyAccJerk-std()-Z"),
                "avg-tBodyGyro-mean-X"=mean(Mergeddata3$"tBodyGyro-mean()-X"),
                "avg-tBodyGyro-mean-Y"=mean(Mergeddata3$"tBodyGyro-mean()-Y"),
                "avg-tBodyGyro-mean-Z"=mean(Mergeddata3$"tBodyGyro-mean()-Z"),
                "avg-tBodyGyro-std-X"=mean(Mergeddata3$"tBodyGyro-std()-X"),
                "avg-tBodyGyro-std-Y"=mean(Mergeddata3$"tBodyGyro-std()-Y"),
                "avg-tBodyGyro-std-Z"=mean(Mergeddata3$"tBodyGyro-std()-Z"),
                "avg-tBodyGyroJerk-mean-X"=mean(Mergeddata3$"tBodyGyroJerk-mean()-X"),
                "avg-tBodyGyroJerk-mean-Y"=mean(Mergeddata3$"tBodyGyroJerk-mean()-Y"),
                "avg-tBodyGyroJerk-mean-Z"=mean(Mergeddata3$"tBodyGyroJerk-mean()-Z"),
                "avg-tBodyGyroJerk-std-X"=mean(Mergeddata3$"tBodyGyroJerk-std()-X"),
                "avg-tBodyGyroJerk-std-Y"=mean(Mergeddata3$"tBodyGyroJerk-std()-Y"),
                "avg-tBodyGyroJerk-std-Z"=mean(Mergeddata3$"tBodyGyroJerk-std()-Z"),
                "avg-tBodyAccMag-mean"=mean(Mergeddata3$"tBodyAccMag-mean()"),
                "avg-tBodyAccMag-std"=mean(Mergeddata3$"tBodyAccMag-std()"),
                "avg-tGravityAccMag-mean"=mean(Mergeddata3$"tGravityAccMag-mean()"),
                "avg-tGravityAccMag-std"=mean(Mergeddata3$"tGravityAccMag-std()"),
                "avg-tBodyAccJerkMag-mean"=mean(Mergeddata3$"tBodyAccJerkMag-mean()"),
                "avg-tBodyAccJerkMag-std"=mean(Mergeddata3$"tBodyAccJerkMag-std()"),
                "avg-tBodyGyroMag-mean"=mean(Mergeddata3$"tBodyGyroMag-mean()"),
                "avg-tBodyGyroMag-std"=mean(Mergeddata3$"tBodyGyroMag-std()"),
                "avg-tBodyGyroJerkMag-mean"=mean(Mergeddata3$"tBodyGyroJerkMag-mean()"),
                "avg-tBodyGyroJerkMag-std"=mean(Mergeddata3$"tBodyGyroJerkMag-std()"),
                "avg-fBodyAcc-mean-X"=mean(Mergeddata3$"fBodyAcc-mean()-X"),
                "avg-fBodyAcc-mean-Y"=mean(Mergeddata3$"fBodyAcc-mean()-Y"),
                "avg-fBodyAcc-mean-Z"=mean(Mergeddata3$"fBodyAcc-mean()-Z"),
                "avg-fBodyAcc-std-X"=mean(Mergeddata3$"fBodyAcc-std()-X"),
                "avg-fBodyAcc-std-Y"=mean(Mergeddata3$"fBodyAcc-std()-Y"),
                "avg-fBodyAcc-std-Z"=mean(Mergeddata3$"fBodyAcc-std()-Z"),
                "avg-fBodyAccJerk-mean-X"=mean(Mergeddata3$"fBodyAccJerk-mean()-X"),
                "avg-fBodyAccJerk-mean-Y"=mean(Mergeddata3$"fBodyAccJerk-mean()-Y"),
                "avg-fBodyAccJerk-mean-Z"=mean(Mergeddata3$"fBodyAccJerk-mean()-Z"),
                "avg-fBodyAccJerk-std-X"=mean(Mergeddata3$"fBodyAccJerk-std()-X"),
                "avg-fBodyAccJerk-std-Y"=mean(Mergeddata3$"fBodyAccJerk-std()-Y"),
                "avg-fBodyAccJerk-std-Z"=mean(Mergeddata3$"fBodyAccJerk-std()-Z"),
                "avg-fBodyGyro-mean-X"=mean(Mergeddata3$"fBodyGyro-mean()-X"),
                "avg-fBodyGyro-mean-Y"=mean(Mergeddata3$"fBodyGyro-mean()-Y"),
                "avg-fBodyGyro-mean-Z"=mean(Mergeddata3$"fBodyGyro-mean()-Z"),
                "avg-fBodyGyro-std-X"=mean(Mergeddata3$"fBodyGyro-std()-X"),
                "avg-fBodyGyro-std-Y"=mean(Mergeddata3$"fBodyGyro-std()-Y"),
                "avg-fBodyGyro-std-Z"=mean(Mergeddata3$"fBodyGyro-std()-Z"),
                "avg-fBodyAccMag-mean"=mean(Mergeddata3$"fBodyAccMag-mean()"),
                "avg-fBodyAccMag-std"=mean(Mergeddata3$"fBodyAccMag-std()"),
                "avg-fBodyBodyAccJerkMag-mean"=mean(Mergeddata3$"fBodyBodyAccJerkMag-mean()"),
                "avg-fBodyBodyAccJerkMag-std"=mean(Mergeddata3$"fBodyBodyAccJerkMag-std()"),
                "avg-fBodyBodyGyroMag-mean"=mean(Mergeddata3$"fBodyBodyGyroMag-mean()"),
                "avg-fBodyBodyGyroMag-std"=mean(Mergeddata3$"fBodyBodyGyroMag-std()"),
                "avg-fBodyBodyGyroJerkMag-mean"=mean(Mergeddata3$"fBodyBodyGyroJerkMag-mean()"),
                "avg-fBodyBodyGyroJerkMag-std"=mean(Mergeddata3$"fBodyBodyGyroJerkMag-std()"),
                "avg-angle(tBodyAccMeangravity)"=mean(Mergeddata3$"angle(tBodyAccMeangravity)"),
                "avg-angle(tBodyAccJerkMean)gravityMean)"=mean(Mergeddata3$"angle(tBodyAccJerkMean)gravityMean)"),
                "avg-angle(tBodyGyroMean,gravityMean)"=mean(Mergeddata3$"angle(tBodyGyroMean,gravityMean)"),
                "avg-angle(tBodyGyroJerkMean,gravityMean)"=mean(Mergeddata3$"angle(tBodyGyroJerkMean,gravityMean)"),
                "avg-angle(X,gravityMean)"=mean(Mergeddata3$"angle(X,gravityMean)"),
                "avg-angle(Y,gravityMean)"=mean(Mergeddata3$"angle(Y,gravityMean)"),
                "avg-angle(Z,gravityMean)"=mean(Mergeddata3$"angle(Z,gravityMean)")
      )


##Take a look at/review the layout & data##
head(AveVariablebySubjectActivity)

            
##Save the table from prior step "AveVariablebySubjectActivity" to a text file for upload to Coursera##
write.table(x=AveVariablebySubjectActivity, file="./TidyData.txt", sep="\t")


      
